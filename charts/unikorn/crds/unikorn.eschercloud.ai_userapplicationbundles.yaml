---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.12.1
  name: userapplicationbundles.unikorn.eschercloud.ai
spec:
  group: unikorn.eschercloud.ai
  names:
    categories:
    - unikorn
    kind: UserApplicationBundle
    listKind: UserApplicationBundleList
    plural: userapplicationbundles
    singular: userapplicationbundle
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.conditions[?(@.type=="Available")].reason
      name: status
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: UserApplicationBundle defines a user defined collection of applications.
          This functions in much the same way as a package manager e.g. you install
          "python" and the package manager handles any dependencies and recommended
          additional packages. For entities like Clusters and ControlPlanes, The ApplicationBundle
          types are used instead.
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: UserApplicationBundleSpec defines the requested state of
              applications on the chosen cluster.
            properties:
              applications:
                description: Applications defines the desired set of applications
                  to install. This does not need to explicitly define prerequisites,
                  a management engine should perform this for you and indicate the
                  full list of installed applications both explicit and implied in
                  the status.
                items:
                  properties:
                    name:
                      description: Name is the name of the application.  This must
                        match what is encoded into Unikorn's application management
                        engine.
                      type: string
                    reference:
                      description: Reference is a reference to the application definition.
                      properties:
                        kind:
                          description: Kind is the kind of resource we are referencing.
                          enum:
                          - HelmApplication
                          type: string
                        name:
                          description: Name is the name of the resource we are referencing.
                          type: string
                        version:
                          description: 'Version is the version of the application
                            within the application type. TODO: make mandatory.'
                          type: string
                      required:
                      - kind
                      - name
                      type: object
                  required:
                  - name
                  - reference
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - name
                x-kubernetes-list-type: map
              clusterName:
                description: ClusterName is the cluster name that the application
                  set is for. You must only define one per-cluster to avoid split
                  brain problems. The cluster must exist in the same namespace as
                  the UserApplicationBundle.
                type: string
              pause:
                description: Pause, if true, will inhibit reconciliation.
                type: boolean
            required:
            - applications
            - clusterName
            type: object
          status:
            description: UserApplicationBundleStatus defines status conditions for
              the application set and individual applications within it.
            properties:
              applicationStatuses:
                description: Applications defines a list of applications that have
                  been selected to be installed my the management engine, and their
                  status.
                items:
                  properties:
                    conditions:
                      description: Conditions provides per-application status.
                      items:
                        description: Condition is a generic condition type for use
                          across all resource types. It's generic so that the underlying
                          controller-manager functionality can be shared across all
                          resources.
                        properties:
                          lastTransitionTime:
                            description: Last time the condition transitioned from
                              one status to another.
                            format: date-time
                            type: string
                          message:
                            description: Human-readable message indicating details
                              about last transition.
                            type: string
                          reason:
                            description: Unique, one-word, CamelCase reason for the
                              condition's last transition.
                            enum:
                            - Provisioning
                            - Provisioned
                            - Cancelled
                            - Errored
                            - Deprovisioning
                            - Deprovisioned
                            type: string
                          status:
                            description: Status is the status of the condition. Can
                              be True, False, Unknown.
                            type: string
                          type:
                            description: Type is the type of the condition.
                            enum:
                            - Available
                            type: string
                        required:
                        - lastTransitionTime
                        - message
                        - reason
                        - status
                        - type
                        type: object
                      type: array
                    endpoint:
                      description: Endpoint is an optional HTTPS endpoint to get access
                        to the application.
                      type: string
                    name:
                      description: Name is the application name.
                      type: string
                  required:
                  - name
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - name
                x-kubernetes-list-type: map
              conditions:
                description: Conditions define overall status for the application
                  set.
                items:
                  description: Condition is a generic condition type for use across
                    all resource types. It's generic so that the underlying controller-manager
                    functionality can be shared across all resources.
                  properties:
                    lastTransitionTime:
                      description: Last time the condition transitioned from one status
                        to another.
                      format: date-time
                      type: string
                    message:
                      description: Human-readable message indicating details about
                        last transition.
                      type: string
                    reason:
                      description: Unique, one-word, CamelCase reason for the condition's
                        last transition.
                      enum:
                      - Provisioning
                      - Provisioned
                      - Cancelled
                      - Errored
                      - Deprovisioning
                      - Deprovisioned
                      type: string
                    status:
                      description: Status is the status of the condition. Can be True,
                        False, Unknown.
                      type: string
                    type:
                      description: Type is the type of the condition.
                      enum:
                      - Available
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
